import{j as W}from"./jsx-runtime-_e34SzbC.js";import{c as pe}from"./utils-vGQRoZUn.js";import{r as t}from"./index-DVXBtNgz.js";var Me=Object.defineProperty,ke=Object.defineProperties,De=Object.getOwnPropertyDescriptors,Q=Object.getOwnPropertySymbols,me=Object.prototype.hasOwnProperty,fe=Object.prototype.propertyIsEnumerable,de=(e,o,l)=>o in e?Me(e,o,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[o]=l,je=(e,o)=>{for(var l in o||(o={}))me.call(o,l)&&de(e,l,o[l]);if(Q)for(var l of Q(o))fe.call(o,l)&&de(e,l,o[l]);return e},Re=(e,o)=>ke(e,De(o)),Oe=(e,o)=>{var l={};for(var u in e)me.call(e,u)&&o.indexOf(u)<0&&(l[u]=e[u]);if(e!=null&&Q)for(var u of Q(e))o.indexOf(u)<0&&fe.call(e,u)&&(l[u]=e[u]);return l},We="^\\d+$";function Be(e){let o=setTimeout(e,0),l=setTimeout(e,10),u=setTimeout(e,50);return[o,l,u]}function Ie(e){let o=t.useRef();return t.useEffect(()=>{o.current=e}),o.current}var Te=18,ge=40,_e=`${ge}px`,Ae=["[data-lastpass-icon-root]","com-1password-button","[data-dashlanecreated]",'[style$="2147483647 !important;"]'].join(",");function Fe({containerRef:e,inputRef:o,pushPasswordManagerStrategy:l,isFocused:u}){let w=t.useRef({done:!1,refocused:!1}),[s,z]=t.useState(!1),[x,V]=t.useState(!1),[B,q]=t.useState(!1),X=t.useMemo(()=>l==="none"?!1:(l==="increase-width"||l==="experimental-no-flickering")&&s&&x,[s,x,l]),P=t.useCallback(()=>{let f=e.current,p=o.current;if(!f||!p||B||l==="none")return;let a=f,b=a.getBoundingClientRect().left+a.offsetWidth,I=a.getBoundingClientRect().top+a.offsetHeight/2,U=b-Te,J=I;if(!(document.querySelectorAll(Ae).length===0&&document.elementFromPoint(U,J)===f)&&(z(!0),q(!0),!w.current.refocused&&document.activeElement===p)){let F=[p.selectionStart,p.selectionEnd];p.blur(),p.focus(),p.setSelectionRange(F[0],F[1]),w.current.refocused=!0}},[e,o,B,l]);return t.useEffect(()=>{let f=e.current;if(!f||l==="none")return;function p(){let b=window.innerWidth-f.getBoundingClientRect().right;V(b>=ge)}p();let a=setInterval(p,1e3);return()=>{clearInterval(a)}},[e,l]),t.useEffect(()=>{let f=u||document.activeElement===o.current;if(l==="none"||!f)return;let p=setTimeout(P,0),a=setTimeout(P,2e3),b=setTimeout(P,5e3),I=setTimeout(()=>{q(!0)},6e3);return()=>{clearTimeout(p),clearTimeout(a),clearTimeout(b),clearTimeout(I)}},[o,u,l,P]),{hasPWMBadge:s,willPushPWMBadge:X,PWM_BADGE_SPACE_WIDTH:_e}}var He=t.createContext({}),ve=t.forwardRef((e,o)=>{var l=e,{value:u,onChange:w,maxLength:s,textAlign:z="left",pattern:x=We,inputMode:V="numeric",onComplete:B,pushPasswordManagerStrategy:q="increase-width",containerClassName:X,noScriptCSSFallback:P=Le,render:f,children:p}=l,a=Oe(l,["value","onChange","maxLength","textAlign","pattern","inputMode","onComplete","pushPasswordManagerStrategy","containerClassName","noScriptCSSFallback","render","children"]),b,I,U,J,F;let[he,be]=t.useState(typeof a.defaultValue=="string"?a.defaultValue:""),d=u??he,M=Ie(d),H=t.useCallback(n=>{w==null||w(n),be(n)},[w]),h=t.useMemo(()=>x?typeof x=="string"?new RegExp(x):x:null,[x]),c=t.useRef(null),Y=t.useRef(null),Z=t.useRef({value:d,onChange:H,isIOS:typeof window<"u"&&((I=(b=window==null?void 0:window.CSS)==null?void 0:b.supports)==null?void 0:I.call(b,"-webkit-touch-callout","none"))}),K=t.useRef({prev:[(U=c.current)==null?void 0:U.selectionStart,(J=c.current)==null?void 0:J.selectionEnd,(F=c.current)==null?void 0:F.selectionDirection]});t.useImperativeHandle(o,()=>c.current,[]),t.useEffect(()=>{let n=c.current,r=Y.current;if(!n||!r)return;Z.current.value!==n.value&&Z.current.onChange(n.value),K.current.prev=[n.selectionStart,n.selectionEnd,n.selectionDirection];function m(){if(document.activeElement!==n){N(null),$(null);return}let i=n.selectionStart,v=n.selectionEnd,E=n.selectionDirection,D=n.maxLength,j=n.value,A=K.current.prev,y=-1,C=-1,R;if(j.length!==0&&i!==null&&v!==null){let ye=i===v,Ce=i===j.length&&j.length<D;if(ye&&!Ce){let O=i;if(O===0)y=0,C=1,R="forward";else if(O===D)y=O-1,C=O,R="backward";else if(D>1&&j.length>1){let ne=0;if(A[0]!==null&&A[1]!==null){R=O<A[1]?"backward":"forward";let Pe=A[0]===A[1]&&A[0]<D;R==="backward"&&!Pe&&(ne=-1)}y=ne+O,C=ne+O+1}}y!==-1&&C!==-1&&y!==C&&c.current.setSelectionRange(y,C,R)}let ce=y!==-1?y:i,se=C!==-1?C:v,Ee=R??E;N(ce),$(se),K.current.prev=[ce,se,Ee]}if(document.addEventListener("selectionchange",m,{capture:!0}),m(),document.activeElement===n&&ee(!0),!document.getElementById("input-otp-style")){let i=document.createElement("style");if(i.id="input-otp-style",document.head.appendChild(i),i.sheet){let v="background: transparent !important; color: transparent !important; border-color: transparent !important; opacity: 0 !important; box-shadow: none !important; -webkit-box-shadow: none !important; -webkit-text-fill-color: transparent !important;";G(i.sheet,"[data-input-otp]::selection { background: transparent !important; color: transparent !important; }"),G(i.sheet,`[data-input-otp]:autofill { ${v} }`),G(i.sheet,`[data-input-otp]:-webkit-autofill { ${v} }`),G(i.sheet,"@supports (-webkit-touch-callout: none) { [data-input-otp] { letter-spacing: -.6em !important; font-weight: 100 !important; font-stretch: ultra-condensed; font-optical-sizing: none !important; left: -1px !important; right: 1px !important; } }"),G(i.sheet,"[data-input-otp] + * { pointer-events: all !important; }")}}let g=()=>{r&&r.style.setProperty("--root-height",`${n.clientHeight}px`)};g();let S=new ResizeObserver(g);return S.observe(n),()=>{document.removeEventListener("selectionchange",m,{capture:!0}),S.disconnect()}},[]);let[re,le]=t.useState(!1),[L,ee]=t.useState(!1),[k,N]=t.useState(null),[T,$]=t.useState(null);t.useEffect(()=>{Be(()=>{var n,r,m,g;(n=c.current)==null||n.dispatchEvent(new Event("input"));let S=(r=c.current)==null?void 0:r.selectionStart,i=(m=c.current)==null?void 0:m.selectionEnd,v=(g=c.current)==null?void 0:g.selectionDirection;S!==null&&i!==null&&(N(S),$(i),K.current.prev=[S,i,v])})},[d,L]),t.useEffect(()=>{M!==void 0&&d!==M&&M.length<s&&d.length===s&&(B==null||B(d))},[s,B,M,d]);let _=Fe({containerRef:Y,inputRef:c,pushPasswordManagerStrategy:q,isFocused:L}),oe=t.useCallback(n=>{let r=n.currentTarget.value.slice(0,s);if(r.length>0&&h&&!h.test(r)){n.preventDefault();return}typeof M=="string"&&r.length<M.length&&document.dispatchEvent(new Event("selectionchange")),H(r)},[s,H,M,h]),ae=t.useCallback(()=>{var n;if(c.current){let r=Math.min(c.current.value.length,s-1),m=c.current.value.length;(n=c.current)==null||n.setSelectionRange(r,m),N(r),$(m)}ee(!0)},[s]),ie=t.useCallback(n=>{var r,m;let g=c.current;if(!Z.current.isIOS||!n.clipboardData||!g)return;let S=n.clipboardData.getData("text/plain");n.preventDefault();let i=(r=c.current)==null?void 0:r.selectionStart,v=(m=c.current)==null?void 0:m.selectionEnd,E=(i!==v?d.slice(0,i)+S+d.slice(v):d.slice(0,i)+S+d.slice(i)).slice(0,s);if(E.length>0&&h&&!h.test(E))return;g.value=E,H(E);let D=Math.min(E.length,s-1),j=E.length;g.setSelectionRange(D,j),N(D),$(j)},[s,H,h,d]),Se=t.useMemo(()=>({position:"relative",cursor:a.disabled?"default":"text",userSelect:"none",WebkitUserSelect:"none",pointerEvents:"none"}),[a.disabled]),ue=t.useMemo(()=>({position:"absolute",inset:0,width:_.willPushPWMBadge?`calc(100% + ${_.PWM_BADGE_SPACE_WIDTH})`:"100%",clipPath:_.willPushPWMBadge?`inset(0 ${_.PWM_BADGE_SPACE_WIDTH} 0 0)`:void 0,height:"100%",display:"flex",textAlign:z,opacity:"1",color:"transparent",pointerEvents:"all",background:"transparent",caretColor:"transparent",border:"0 solid transparent",outline:"0 solid transparent",boxShadow:"none",lineHeight:"1",letterSpacing:"-.5em",fontSize:"var(--root-height)",fontFamily:"monospace",fontVariantNumeric:"tabular-nums"}),[_.PWM_BADGE_SPACE_WIDTH,_.willPushPWMBadge,z]),we=t.useMemo(()=>t.createElement("input",Re(je({autoComplete:a.autoComplete||"one-time-code"},a),{"data-input-otp":!0,"data-input-otp-mss":k,"data-input-otp-mse":T,inputMode:V,pattern:h==null?void 0:h.source,style:ue,maxLength:s,value:d,ref:c,onPaste:n=>{var r;ie(n),(r=a.onPaste)==null||r.call(a,n)},onChange:oe,onMouseOver:n=>{var r;le(!0),(r=a.onMouseOver)==null||r.call(a,n)},onMouseLeave:n=>{var r;le(!1),(r=a.onMouseLeave)==null||r.call(a,n)},onFocus:n=>{var r;ae(),(r=a.onFocus)==null||r.call(a,n)},onBlur:n=>{var r;ee(!1),(r=a.onBlur)==null||r.call(a,n)}})),[oe,ae,ie,V,ue,s,T,k,a,h==null?void 0:h.source,d]),te=t.useMemo(()=>({slots:Array.from({length:s}).map((n,r)=>{let m=L&&k!==null&&T!==null&&(k===T&&r===k||r>=k&&r<T),g=d[r]!==void 0?d[r]:null;return{char:g,isActive:m,hasFakeCaret:m&&g===null}}),isFocused:L,isHovering:!a.disabled&&re}),[L,re,s,T,k,a.disabled,d]),xe=t.useMemo(()=>f?f(te):t.createElement(He.Provider,{value:te},p),[p,te,f]);return t.createElement(t.Fragment,null,P!==null&&t.createElement("noscript",null,t.createElement("style",null,P)),t.createElement("div",{ref:Y,"data-input-otp-container":!0,style:Se,className:X},xe,t.createElement("div",{style:{position:"absolute",inset:0,pointerEvents:"none"}},we)))});ve.displayName="Input";function G(e,o){try{e.insertRule(o)}catch{console.error("input-otp could not insert CSS rule:",o)}}var Le=`
[data-input-otp] {
  --nojs-bg: white !important;
  --nojs-fg: black !important;

  background-color: var(--nojs-bg) !important;
  color: var(--nojs-fg) !important;
  caret-color: var(--nojs-fg) !important;
  letter-spacing: .25em !important;
  text-align: center !important;
  border: 1px solid var(--nojs-fg) !important;
  border-radius: 4px !important;
  width: 100% !important;
}
@media (prefers-color-scheme: dark) {
  [data-input-otp] {
    --nojs-bg: black !important;
    --nojs-fg: white !important;
  }
}`;const Ne=e=>W.jsx("div",{className:pe("relative h-[58px] w-11 font-Inter text-[2rem] text-xl font-bold text-212121","flex items-center justify-center gap-x-[6px]","transition-all duration-300","rounded-md border border-D9DDE1","group-focus-within:border-D9DDE1","outline-accent-foreground/60 outline outline-0",{"outline-accent-foreground border-0 outline-1":e.char},{"accent-foreground border-0 outline-1 outline-D50032":e.error},{"outline-accent-foreground border-0 outline-1":e.char&&e.error}),children:e.char!==null&&W.jsx("div",{children:e.char})}),$e=t.forwardRef((e,o)=>W.jsx(ve,{ref:o,maxLength:4,value:e.value,onChange:l=>{e.onChange&&e.onChange(l)},onComplete:l=>{e.onComplete&&e.onComplete(l)},disabled:e.disabled,containerClassName:pe("group flex items-center has-[:disabled]:opacity-30",e.className),render:({slots:l})=>W.jsx(W.Fragment,{children:W.jsx("div",{className:"flex gap-x-[6px]",children:l.map((u,w)=>W.jsx(Ne,{error:e.error,...u},w))})})}));$e.__docgenInfo={description:"",methods:[],displayName:"StyledOptInput"};export{$e as S};
